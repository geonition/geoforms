{% extends "base_map.html"%}
{% load i18n %}

{% block stylesheet %}
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/questionnaire.css" />
    <link href="{{ STATIC_URL }}css/jquery-ui-1.8.19.custom.css" rel="stylesheet" type="text/css"/>
{% endblock %}

{% block content %}
    
<ul class="breadcrumb base_bgcolor">
    <li class="disk hover" onclick="window.location = '{% url dashboard %}'">
    </li>
    <li class="separator">
    </li>
    <li class="active">
        <h3>
            {{ questionnaire.name }}
        </h3>
    </li>
</ul>

<div id="forms">
    {% for form in form_list %}
        <h3 class="section{{ forloop.counter }}">
            <a href="#">{{ form.name }} {{ forloop.counter }}/{{ form_list|length }}</a>
        </h3>
        <div>
            <form name="{{ form.slug }}" method="post" action="#">
                {% for key, value in elements.items %}
                    {% if key == form.slug %}
                        {% for element in value %}
                        <div class="form_element">
                            {{ element.html|safe }}
                        </div>
                        {% endfor %}
                    {% endif %}
                {% endfor %}
            
            
            <div class="form_element">
                <p>
                {% if form_list|length == 1 %}
                {% elif forloop.first %}
                    <a class="next" href="#section{{ forloop.counter|add:'1' }}">{% trans 'Next' %}&rarr;</a>
                {% elif forloop.last %}
                    {% trans "You have now reached the end of the questionnaire. Thank you for your answers! You can still continue modifying your answers by following the previous links or clicking the sections of this questionnaire." %}
                    <br />
                    <a class="previous" href="#section{{ forloop.counter|add:'-1' }}">&larr;{% trans 'Previous' %}</a>
                {% else %}
                    <a class="previous" href="#section{{ forloop.counter|add:'-1' }}">&larr;{% trans 'Previous' %}</a>
                    <a class="next" href="#section{{ forloop.counter|add:'1' }}">{% trans 'Next' %}&rarr;</a>
                {% endif %}
                </p>
            </div>
            
            </form>
        </div>
    {% endfor %}
</div>

<div id="popups">
    {% for form in popup_list %}
        <div id="{{ form.slug }}">
            <form name="{{ form.slug }}" method="post" action="#" class="popupform">
                
                {% for key, value in elements.items %}
                    {% if key == form.slug %}
                        {% for element in value %}
                        <div class="form_element">
                            {{ element.html|safe }}
                        </div>
                        {% endfor %}
                    {% endif %}
                {% endfor %}
                
                <button type="button" class="remove">
                    {% trans 'Remove' %}
                </button>
                <button type="button" class="save">
                    {% trans 'Save' %}
                </button>
            </form>
        </div>
    {% endfor %}
</div>


{% endblock %}

{% block javascript %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
<script src="https://softgis.org.aalto.fi/OpenLayers212/OpenLayers.js"></script>
<script type="text/javascript" src="{% url api_javascript %}"></script>
<script type="text/javascript" src="{% url map_js map_slug_name=map_slug %}"></script>
<script type="text/javascript">
var data_group = 'Q-{{ questionnaire.slug }}';
var questionnaire_area = {{ questionnaire.area.json|safe }};

jQuery(document).ready(function() {
    gnt.questionnaire.init('#forms', '', '#forms', questionnaire_area, data_group);
});
</script>
{% endblock javascript %}

